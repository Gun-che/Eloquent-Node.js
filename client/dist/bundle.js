!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(t,e){return fetch(t,e).then((function(t){if(t.status<400)return t;throw new Error(t.statusText)}))},o=function(t){return"talks/"+encodeURIComponent(t)},a=function(t){alert(String(t))},l=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function l(t){try{i(r.next(t))}catch(t){a(t)}}function u(t){try{i(r.throw(t))}catch(t){a(t)}}function i(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,u)}i((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,r=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(o=l.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){l.label=a[1];break}if(6===a[0]&&l.label<o[1]){l.label=o[1],o=a;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(a);break}o[2]&&l.ops.pop(),l.trys.pop();continue}a=e.call(t,l)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(t,e){for(var n,r,o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var l=document.createElement(t);e&&Object.assign(l,e);try{for(var u=i(o),c=u.next();!c.done;c=u.next()){var s=c.value;"string"!=typeof s?l.appendChild(s):l.appendChild(document.createTextNode(s))}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return l},s=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)l.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return l},f=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},p=function(t,e){return c.apply(void 0,f(["section",{className:"talk"},c("h2",null,t.title," ",c("button",{onclick:function(){e({type:"deleteTalk",talk:t.title})}},"Delete")),c("div",null,"by ",c("strong",null,t.presenter)),c("p",null,t.summary)],t.comments.map(y),[c("form",{onsubmit:function(n){n.preventDefault();var r=n.target;e({type:"newComment",talk:t.title,message:r.elements.comment.value}),r.reset()}},c("input",{type:"text",name:"comment"})," ",c("button",{type:"submit"},"Add comment"))]))};function y(t){return c("p",{className:"comment"},c("strong",null,t.autor),": ",t.message)}var d=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m=function(){function t(t,e){this.dispatch=e,this.talkDOM=c("div",{className:"talks"}),this.dom=c("div",null,function(t,e){return c("label",{},"Your name",c("input",{type:"text",value:t,onchange:function(t){e({type:"setUser",user:t.target.value})}}))}(t.user,e),this.talkDOM,function(t){var e=c("input",{type:"text"}),n=c("input",{type:"text"});return c("form",{onsubmit:function(r){r.preventDefault(),t({type:"newTalk",title:e.value,summary:n.value}),r.target.reset()}},c("h3",null,"Submit a Talk"),c("label",null,"Title: ",e),c("label",null,"Summary: ",n),c("button",{type:"submit"},"Submit"))}(e)),this.syncState(t)}return t.prototype.syncState=function(t){var e,n;if(t.talks!=this.talks){this.talkDOM.textContent="";try{for(var r=d(t.talks),o=r.next();!o.done;o=r.next()){var a=o.value;this.talkDOM.appendChild(p(a,this.dispatch))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.talks=t.talks}},t}(),h=function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};!function(){var t,e,n,i=localStorage.getItem("newUser")||"Anon";function c(n){t=function(t,e){return"setUser"===e.type?(localStorage.setItem("userName",e.user),h(h({},t),{user:e.user})):"setTalks"===e.type?h(h({},t),{talks:e.talks}):("newTalk"===e.type?r(o(e.title),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({presenter:t.user,summary:e.summary})}).catch(a):"deletTalk"===e.type?r(o(e.title),{method:"DELETE"}).catch(a):"newComment"===e.type&&r(o(e.title)+"/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({author:t.user,message:e.message})}).catch(a),t)}(t,n),e.syncState(t)}(n=function(n){e?c({type:"setTalks",talks:n}):(e=new m(t={user:i,talks:n},c),document.body.appendChild(e.dom))},l(void 0,void 0,void 0,(function(){var t,e,o,a;return u(this,(function(l){switch(l.label){case 0:t=void 0,l.label=1;case 1:e=void 0,l.label=2;case 2:return l.trys.push([2,4,,6]),[4,r("/talks",{headers:t&&{"If-None-Match":t,Prefer:"wait=90"}})];case 3:return e=l.sent(),[3,6];case 4:return o=l.sent(),console.log("Request failed: "+o),[4,new Promise((function(t){return setTimeout(t,500)}))];case 5:return l.sent(),[3,8];case 6:return 304===e.status?[3,8]:(t=e.headers.get("Etag"),a=n,[4,e.json()]);case 7:a.apply(void 0,[l.sent()]),l.label=8;case 8:return[3,1];case 9:return[2]}}))}))).catch(a)}()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ZldGNoSGVscGVycy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvZWx0LnRzIiwid2VicGFjazovLy8uL3NyYy9yZW5kZXJGdW5jdGlvbnMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1NraWxsU2hhcmVBcHAudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9wb2xsVGFsa3MudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hhbmRsZUFjdGlvbi50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImZldGNoT2siLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJFcnJvciIsInN0YXR1c1RleHQiLCJ0YWxrVVJMIiwidGl0bGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJyZXBvcnRFcnJvciIsImVyciIsImFsZXJ0IiwiU3RyaW5nIiwiZWx0IiwidHlwZSIsInByb3BzIiwiZG9tIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiYXNzaWduIiwiY2hpbGRyZW4iLCJjaGlsZCIsImFwcGVuZENoaWxkIiwiY3JlYXRlVGV4dE5vZGUiLCJyZW5kZXJUYWxrIiwidGFsayIsImRpc3BhdGNoIiwiY2xhc3NOYW1lIiwib25jbGljayIsInByZXNlbnRlciIsInN1bW1hcnkiLCJjb21tZW50cyIsIm1hcCIsInJlbmRlckNvbW1lbnQiLCJvbnN1Ym1pdCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm0iLCJ0YXJnZXQiLCJtZXNzYWdlIiwiZWxlbWVudHMiLCJjb21tZW50IiwicmVzZXQiLCJhdXRvciIsInN0YXRlIiwidGhpcyIsInRhbGtET00iLCJvbmNoYW5nZSIsInVzZXIiLCJyZW5kZXJVZXNyRmllbGQiLCJldmVudCIsInJlbmRlclRhbGtGb3JtIiwic3luY1N0YXRlIiwidGFsa3MiLCJ0ZXh0Q29udGVudCIsImFwcCIsInVwZGF0ZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJhY3Rpb24iLCJzZXRJdGVtIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY2F0Y2giLCJhdXRob3IiLCJoYW5kbGVBY3Rpb24iLCJ0YWciLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwibG9nIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwianNvbiIsInJ1bkFwcCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFT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LFdBQVl1QyxNQUFLLEtBSmxDRSxFQUFNLElBQUksRUFEVlgsRUFBUSxDQUFFSSxLQUFJLEVBQUVLLE1BQUssR0FDVTNCLEdBQy9CVCxTQUFTOEMsS0FBS3pDLFlBQVlpQyxFQUFJdkMsT0NqQkUsbUMsOERBQ2hDcUQsT0FBTUMsRSxpQkFHSnBFLE9BQVEsRSxpQkFFQyxPLHNCQUFBLEdBQU1MLEVBQVEsU0FBVSxDQUNqQ2lFLFFBQVNPLEdBQU8sQ0FDZCxnQkFBaUJBLEVBQ2pCLE9BQVUsYyxjQUhkbkUsRUFBVyxTLGFBUVgsTyxXQURBcUUsUUFBUUMsSUFBSSxtQkFBcUIsR0FDakMsR0FBTSxJQUFJQyxTQUFRLFNBQUFDLEdBQVcsT0FBQUMsV0FBV0QsRUFBUyxTLE9BQ2pELE9BREEsU0FDQSxNLE9BR0YsT0FBd0IsTUFBcEJ4RSxFQUFTQyxPQUFnQixPQUU3QmtFLEVBQU1uRSxFQUFTNEQsUUFBUXBGLElBQUksUUFDM0IsRUFBQThFLEVBQU8sR0FBTXRELEVBQVMwRSxTLE9BQXRCLGdCQUFPLFcsc0REQ05WLE1BQU16RCxHQUdYb0UiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGNvbnN0IGZldGNoT2sgPSAodXJsOiBSZXF1ZXN0SW5mbywgb3B0aW9uczogUmVxdWVzdEluaXQpID0+IHtcclxuICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPCA0MDApIHtcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlXHJcblxyXG4gICAgfSBlbHNlIHRocm93IG5ldyBFcnJvcihyZXNwb25zZS5zdGF0dXNUZXh0KTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHRhbGtVUkwgPSAodGl0bGU6IHN0cmluZykgPT4ge1xyXG4gIHJldHVybiAndGFsa3MvJyArIGVuY29kZVVSSUNvbXBvbmVudCh0aXRsZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCByZXBvcnRFcnJvciA9IChlcnI6IEVycm9yKSA9PiB7XHJcbiAgYWxlcnQoU3RyaW5nKGVycikpO1xyXG59IiwiZXhwb3J0IGNvbnN0IGVsdCA9ICh0eXBlOiBzdHJpbmcsIHByb3BzOiBhbnksIC4uLmNoaWxkcmVuOiAoc3RyaW5nIHwgSFRNTEVsZW1lbnQpW10pID0+IHtcclxuICBsZXQgZG9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0eXBlKTtcclxuXHJcbiAgaWYgKHByb3BzKSBPYmplY3QuYXNzaWduKGRvbSwgcHJvcHMpO1xyXG5cclxuICBmb3IgKGxldCBjaGlsZCBvZiBjaGlsZHJlbikge1xyXG5cclxuICAgIGlmICh0eXBlb2YgY2hpbGQgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIGRvbS5hcHBlbmRDaGlsZChjaGlsZCk7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZG9tLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNoaWxkKSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBkb207XHJcbn0iLCJpbXBvcnQgeyBlbHQgfSBmcm9tICcuL2VsdCc7XHJcblxyXG5leHBvcnQgY29uc3QgcmVuZGVyVWVzckZpZWxkID0gKG5hbWU6IHN0cmluZywgZGlzcGF0Y2g6IGFueSkgPT4ge1xyXG4gIHJldHVybiBlbHQoJ2xhYmVsJywge30sICdZb3VyIG5hbWUnLCBlbHQoJ2lucHV0Jywge1xyXG4gICAgdHlwZTogJ3RleHQnLFxyXG4gICAgdmFsdWU6IG5hbWUsXHJcbiAgICBvbmNoYW5nZShlOiBJbnB1dEV2ZW50KSB7XHJcbiAgICAgIGRpc3BhdGNoKHtcclxuICAgICAgICB0eXBlOiAnc2V0VXNlcicsXHJcbiAgICAgICAgdXNlcjogKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfSkpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcmVuZGVyVGFsayA9ICh0YWxrLCBkaXNwYXRjaCkgPT4ge1xyXG5cclxuICByZXR1cm4gZWx0KCdzZWN0aW9uJywgeyBjbGFzc05hbWU6ICd0YWxrJyB9LFxyXG5cclxuICAgIGVsdCgnaDInLCBudWxsLCB0YWxrLnRpdGxlLCBcIiBcIixcclxuXHJcbiAgICAgIGVsdCgnYnV0dG9uJywge1xyXG4gICAgICAgIG9uY2xpY2soKSB7XHJcbiAgICAgICAgICBkaXNwYXRjaCh7IHR5cGU6ICdkZWxldGVUYWxrJywgdGFsazogdGFsay50aXRsZSB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sICdEZWxldGUnKSksXHJcblxyXG4gICAgZWx0KCdkaXYnLCBudWxsLCAnYnkgJyxcclxuXHJcbiAgICAgIGVsdCgnc3Ryb25nJywgbnVsbCwgdGFsay5wcmVzZW50ZXIpKSxcclxuXHJcbiAgICBlbHQoJ3AnLCBudWxsLCB0YWxrLnN1bW1hcnkpLFxyXG4gICAgLi4udGFsay5jb21tZW50cy5tYXAocmVuZGVyQ29tbWVudCksXHJcblxyXG4gICAgZWx0KCdmb3JtJywge1xyXG4gICAgICBvbnN1Ym1pdChlOiBJbnB1dEV2ZW50KSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGxldCBmb3JtID0gZS50YXJnZXQgYXMgSFRNTEZvcm1FbGVtZW50ICYgeyBlbGVtZW50czogeyBjb21tZW50OiB7IHZhbHVlOiBzdHJpbmcgfSB9IH07XHJcbiAgICAgICAgZGlzcGF0Y2goe1xyXG4gICAgICAgICAgdHlwZTogJ25ld0NvbW1lbnQnLFxyXG4gICAgICAgICAgdGFsazogdGFsay50aXRsZSxcclxuICAgICAgICAgIG1lc3NhZ2U6IGZvcm0uZWxlbWVudHMuY29tbWVudC52YWx1ZVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGZvcm0ucmVzZXQoKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0sIGVsdCgnaW5wdXQnLCB7XHJcbiAgICAgIHR5cGU6ICd0ZXh0JyxcclxuICAgICAgbmFtZTogJ2NvbW1lbnQnXHJcbiAgICB9KSwgJyAnLFxyXG5cclxuICAgICAgZWx0KCdidXR0b24nLCB7XHJcbiAgICAgICAgdHlwZTogJ3N1Ym1pdCcsXHJcbiAgICAgIH0sICdBZGQgY29tbWVudCcpXHJcbiAgICApXHJcbiAgKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ29tbWVudChjb21tZW50OiBhbnkpIHtcclxuICByZXR1cm4gZWx0KCdwJywgeyBjbGFzc05hbWU6ICdjb21tZW50JyB9LFxyXG4gICAgZWx0KCdzdHJvbmcnLCBudWxsLCBjb21tZW50LmF1dG9yKSxcclxuICAgICc6ICcsIGNvbW1lbnQubWVzc2FnZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJUYWxrRm9ybShkaXNwYXRjaCkge1xyXG4gIGxldCB0aXRsZSA9IGVsdCgnaW5wdXQnLCB7IHR5cGU6ICd0ZXh0JyB9KSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gIGxldCBzdW1tYXJ5ID0gZWx0KCdpbnB1dCcsIHsgdHlwZTogJ3RleHQnIH0pIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gIHJldHVybiBlbHQoJ2Zvcm0nLCB7XHJcbiAgICBvbnN1Ym1pdChldmVudDogRXZlbnQpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZGlzcGF0Y2goe1xyXG4gICAgICAgIHR5cGU6ICduZXdUYWxrJyxcclxuICAgICAgICB0aXRsZTogdGl0bGUudmFsdWUsXHJcbiAgICAgICAgc3VtbWFyeTogc3VtbWFyeS52YWx1ZSxcclxuICAgICAgfSk7XHJcbiAgICAgIChldmVudC50YXJnZXQgYXMgSFRNTEZvcm1FbGVtZW50KS5yZXNldCgpXHJcbiAgICB9XHJcbiAgfSwgZWx0KCdoMycsIG51bGwsICdTdWJtaXQgYSBUYWxrJyksXHJcbiAgICBlbHQoJ2xhYmVsJywgbnVsbCwgJ1RpdGxlOiAnLCB0aXRsZSksXHJcbiAgICBlbHQoJ2xhYmVsJywgbnVsbCwgJ1N1bW1hcnk6ICcsIHN1bW1hcnkpLFxyXG4gICAgZWx0KCdidXR0b24nLCB7IHR5cGU6ICdzdWJtaXQnIH0sICdTdWJtaXQnKVxyXG4gICk7XHJcbn0iLCJpbXBvcnQgeyBlbHQgfSBmcm9tICcuL2VsdCc7XHJcbmltcG9ydCB7IHJlbmRlclVlc3JGaWVsZCwgcmVuZGVyVGFsa0Zvcm0sIHJlbmRlclRhbGsgfSBmcm9tICcuL3JlbmRlckZ1bmN0aW9ucyc7XHJcblxyXG5leHBvcnQgY2xhc3MgU2tpbGxTaGFyZUFwcCB7XHJcbiAgZGlzcGF0Y2g6IGFueTtcclxuICB0YWxrRE9NOiBIVE1MRWxlbWVudDtcclxuICBkb206IEhUTUxFbGVtZW50O1xyXG4gIHRhbGtzOiBhbnk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHN0YXRlLCBkaXNwYXRjaCkge1xyXG4gICAgdGhpcy5kaXNwYXRjaCA9IGRpc3BhdGNoO1xyXG4gICAgdGhpcy50YWxrRE9NID0gZWx0KCdkaXYnLCB7IGNsYXNzTmFtZTogJ3RhbGtzJyB9KTtcclxuICAgIHRoaXMuZG9tID0gZWx0KCdkaXYnLCBudWxsLFxyXG4gICAgICByZW5kZXJVZXNyRmllbGQoc3RhdGUudXNlciwgZGlzcGF0Y2gpLFxyXG4gICAgICB0aGlzLnRhbGtET00sXHJcbiAgICAgIHJlbmRlclRhbGtGb3JtKGRpc3BhdGNoKSxcclxuICAgIClcclxuICAgIHRoaXMuc3luY1N0YXRlKHN0YXRlKTtcclxuICB9XHJcblxyXG4gIHN5bmNTdGF0ZShzdGF0ZSkge1xyXG4gICAgaWYgKHN0YXRlLnRhbGtzICE9IHRoaXMudGFsa3MpIHtcclxuICAgICAgdGhpcy50YWxrRE9NLnRleHRDb250ZW50ID0gJyc7XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHRhbGsgb2Ygc3RhdGUudGFsa3MpIHtcclxuICAgICAgICB0aGlzLnRhbGtET00uYXBwZW5kQ2hpbGQoXHJcbiAgICAgICAgICByZW5kZXJUYWxrKHRhbGssIHRoaXMuZGlzcGF0Y2gpXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnRhbGtzID0gc3RhdGUudGFsa3M7XHJcbiAgICB9XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgcmVwb3J0RXJyb3IgfSBmcm9tICcuL2ZldGNoSGVscGVycyc7XHJcbmltcG9ydCB7IHBvbGxUYWxrcyB9IGZyb20gJy4vcG9sbFRhbGtzJztcclxuaW1wb3J0IHsgU2tpbGxTaGFyZUFwcCB9IGZyb20gJy4vU2tpbGxTaGFyZUFwcCc7XHJcbmltcG9ydCB7IGhhbmRsZUFjdGlvbiB9IGZyb20gJy4vaGFuZGxlQWN0aW9uJztcclxuXHJcbmZ1bmN0aW9uIHJ1bkFwcCgpIHtcclxuICBsZXQgdXNlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCduZXdVc2VyJykgfHwgJ0Fub24nO1xyXG4gIGxldCBzdGF0ZSwgYXBwOiBTa2lsbFNoYXJlQXBwO1xyXG5cclxuICBmdW5jdGlvbiBkaXNwYXRjaChhY3Rpb24pIHtcclxuICAgIHN0YXRlID0gaGFuZGxlQWN0aW9uKHN0YXRlLCBhY3Rpb24pO1xyXG4gICAgYXBwLnN5bmNTdGF0ZShzdGF0ZSlcclxuICB9XHJcblxyXG4gIHBvbGxUYWxrcyh0YWxrcyA9PiB7XHJcblxyXG4gICAgaWYgKCFhcHApIHtcclxuICAgICAgc3RhdGUgPSB7IHVzZXIsIHRhbGtzIH07XHJcbiAgICAgIGFwcCA9IG5ldyBTa2lsbFNoYXJlQXBwKHN0YXRlLCBkaXNwYXRjaCk7XHJcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYXBwLmRvbSk7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZGlzcGF0Y2goeyB0eXBlOiAnc2V0VGFsa3MnLCB0YWxrcyB9KTtcclxuICAgIH1cclxuICB9KS5jYXRjaChyZXBvcnRFcnJvcilcclxufVxyXG5cclxucnVuQXBwKCk7IiwiaW1wb3J0IHsgZmV0Y2hPayB9IGZyb20gJy4vZmV0Y2hIZWxwZXJzJztcclxuXHJcbmV4cG9ydCBjb25zdCBwb2xsVGFsa3MgPSBhc3luYyAodXBkYXRlKSA9PiB7XHJcbiAgbGV0IHRhZyA9IHVuZGVmaW5lZDtcclxuXHJcbiAgZm9yICg7IDspIHtcclxuICAgIGxldCByZXNwb25zZTtcclxuICAgIHRyeSB7XHJcbiAgICAgIHJlc3BvbnNlID0gYXdhaXQgZmV0Y2hPaygnL3RhbGtzJywge1xyXG4gICAgICAgIGhlYWRlcnM6IHRhZyAmJiB7XHJcbiAgICAgICAgICAnSWYtTm9uZS1NYXRjaCc6IHRhZyxcclxuICAgICAgICAgIFwiUHJlZmVyXCI6ICd3YWl0PTkwJ1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1JlcXVlc3QgZmFpbGVkOiAnICsgZXJyKTtcclxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwMCkpO1xyXG4gICAgICBjb250aW51ZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAzMDQpIGNvbnRpbnVlO1xyXG5cclxuICAgIHRhZyA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdFdGFnJyk7XHJcbiAgICB1cGRhdGUoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IHRhbGtVUkwsIHJlcG9ydEVycm9yLCBmZXRjaE9rIH0gZnJvbSAnLi9mZXRjaEhlbHBlcnMnO1xyXG5leHBvcnQgY29uc3QgaGFuZGxlQWN0aW9uID0gKHN0YXRlLCBhY3Rpb24pID0+IHtcclxuXHJcbiAgaWYgKGFjdGlvbi50eXBlID09PSAnc2V0VXNlcicpIHtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyTmFtZScsIGFjdGlvbi51c2VyKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIC4uLnN0YXRlLFxyXG4gICAgICB1c2VyOiBhY3Rpb24udXNlcixcclxuICAgIH1cclxuXHJcbiAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PT0gJ3NldFRhbGtzJykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgLi4uc3RhdGUsXHJcbiAgICAgIHRhbGtzOiBhY3Rpb24udGFsa3MsXHJcbiAgICB9XHJcblxyXG4gIH0gZWxzZSBpZiAoYWN0aW9uLnR5cGUgPT09ICduZXdUYWxrJykge1xyXG4gICAgZmV0Y2hPayh0YWxrVVJMKGFjdGlvbi50aXRsZSksIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIHByZXNlbnRlcjogc3RhdGUudXNlcixcclxuICAgICAgICBzdW1tYXJ5OiBhY3Rpb24uc3VtbWFyeSxcclxuICAgICAgfSlcclxuXHJcbiAgICB9KS5jYXRjaChyZXBvcnRFcnJvcik7XHJcblxyXG4gIH0gZWxzZSBpZiAoYWN0aW9uLnR5cGUgPT09ICdkZWxldFRhbGsnKSB7XHJcbiAgICBmZXRjaE9rKHRhbGtVUkwoYWN0aW9uLnRpdGxlKSwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCJcclxuICAgIH0pLmNhdGNoKHJlcG9ydEVycm9yKTtcclxuXHJcbiAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PT0gJ25ld0NvbW1lbnQnKSB7XHJcbiAgICBmZXRjaE9rKHRhbGtVUkwoYWN0aW9uLnRpdGxlKSArICcvY29tbWVudHMnLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXV0aG9yOiBzdGF0ZS51c2VyLFxyXG4gICAgICAgIG1lc3NhZ2U6IGFjdGlvbi5tZXNzYWdlLFxyXG4gICAgICB9KVxyXG5cclxuICAgIH0pLmNhdGNoKHJlcG9ydEVycm9yKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBzdGF0ZTtcclxufSJdLCJzb3VyY2VSb290IjoiIn0=